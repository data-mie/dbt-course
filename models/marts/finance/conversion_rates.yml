version: 2

models:
  - name: conversion_rates
    description: Currency conversion rates
    latest_version: 2
    config:
      contract:
        enforced: true
    columns:
      - name: conversion_rate_id
        data_type: text
        tests:
          - not_null
          - unique
        constraints:
          - type: not_null
          - type: unique

      - name: date_day
        data_type: date
        tests:
          - not_null
        constraints:
          - type: not_null

      - name: currency
        data_type: text
        tests:
          - not_null
        constraints:
          - type: not_null

      - name: rate_usd
        data_type: float
        tests:
          - not_null
          - greater_than_zero
        constraints:
          - type: not_null

      - name: source_currency
        data_type: text
        tests:
          - not_null
        constraints:
          - type: not_null

      - name: target_currency
        data_type: text
        tests:
          - not_null
        constraints:
          - type: not_null

      - name: rate
        data_type: float
        tests:
          - not_null
          - greater_than_zero
        constraints:
          - type: not_null

    versions:
      - v: 1
        columns:
          - include: all
            exclude: [rate, source_currency, target_currency]
      - v: 2 # Prerelease version. Renamed two columns -- this is a breaking change!
        columns:
          - include: all
            exclude: [rate_usd, currency]